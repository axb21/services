<project name="react.ui" default="package" basedir=".">
    <description>
        CollectionSpace UI Component buil
    </description>
    <!-- set global properties for this build -->
    <property name="services.trunk" value=".."/>
    <!-- enviornment should be declared before reading build.properties -->
    <property environment="env" />
    <property file="${services.trunk}/build.properties" />
	
	<!--
		Profile version numbers
	-->
    <property name="publicart.profile.plugin.version" value="latest" />
    <property name="publicart.profile.plugin.name" value="cspaceUIPluginProfilePublicArt" />
    <property name="publicart.profile.plugin.dir" value="cspace#publicart" />
    <property name="publicart.profile.plugin.js" value="${publicart.profile.plugin.name}@${publicart.profile.plugin.version}.min.js" />

    <property name="anthro.profile.plugin.version" value="latest" />
    <property name="anthro.profile.plugin.name" value="cspaceUIPluginProfileAnthro" />
    <property name="anthro.profile.plugin.dir" value="cspace#anthro" />
    <property name="anthro.profile.plugin.js" value="${anthro.profile.plugin.name}@${anthro.profile.plugin.version}.min.js" />
    
	<property name="dvp.profile.plugin.version" value="latest" />
	<property name="dvp.profile.plugin.name" value="cspaceUIPluginProfileDartmouthVietnamProject" />
	<property name="dvp.profile.plugin.dir" value="cspace#dvp" />
	<property name="dvp.profile.plugin.js" value="${dvp.profile.plugin.name}@${dvp.profile.plugin.version}.min.js" />

    <condition property="osfamily-unix">
        <os family="unix" />
    </condition>
    <condition property="osfamily-windows">
        <os family="windows" />
    </condition>
    
    <target name="package" depends="deploy">
    </target>
    
    <target name="download">
    	<!-- Core UI -->
        <exec executable="curl"  failonerror="true">
            <arg line="-o ${cspace.ui.js} --fail --insecure --remote-name --location https://unpkg.com/cspace-ui@${cspace.ui.version}/dist/${cspace.ui.webapp.name}.min.js"/>
        </exec>
        
        <!-- Public Art Profile -->
        <exec executable="curl"  failonerror="true">
            <arg line="-o ${publicart.profile.plugin.js} --fail --insecure --remote-name --location https://unpkg.com/cspace-ui-plugin-profile-publicart@${publicart.profile.plugin.version}/dist/${publicart.profile.plugin.name}.min.js"/>
        </exec>
        
        <!-- Anthropology Profile -->
        <exec executable="curl"  failonerror="true">
            <arg line="-o ${anthro.profile.plugin.js} --fail --insecure --remote-name --location https://unpkg.com/cspace-ui-plugin-profile-anthro@${anthro.profile.plugin.version}/dist/${anthro.profile.plugin.name}.min.js"/>
        </exec>
        
        <!-- DVP Profile -->
        <exec executable="curl"  failonerror="true">
            <arg line="-o ${dvp.profile.plugin.js} --fail --insecure --remote-name --location https://unpkg.com/cspace-ui-plugin-profile-dvp@${dvp.profile.plugin.version}/dist/${dvp.profile.plugin.name}.min.js"/>
        </exec>
    </target>
    
    <target name="deploy" depends="download" description="deploy cspace ui to ${jee.server.cspace}">
    	<!-- Core UI Webapp-->
        <filter token="UI_VERSION" value="${cspace.ui.version}" />
        <copy todir="${jee.deploy.cspace}/${cspace.ui.webapp}" filtering="true" overwrite="true">
            <fileset dir="${cspace.ui.webapp}"/>
        </copy>
        <move file="${cspace.ui.webapp.name}@${cspace.ui.version}.min.js" todir="${jee.deploy.cspace.ui.shared}"></move>
        
        <!-- Public Art Profile -->
		<filter token="PLUGIN_VERSION" value="${publicart.profile.plugin.version}" />
        <copy todir="${jee.deploy.cspace}/${publicart.profile.plugin.dir}" filtering="true" overwrite="true">
            <fileset dir="${publicart.profile.plugin.dir}"/>
        </copy>
        <move file="${publicart.profile.plugin.name}@${publicart.profile.plugin.version}.min.js" todir="${jee.deploy.cspace.ui.shared}"></move>
        
        <!-- Anthropology Profile -->
		<filter token="PLUGIN_VERSION" value="${anthro.profile.plugin.version}" />
        <copy todir="${jee.deploy.cspace}/${anthro.profile.plugin.dir}" filtering="true" overwrite="true">
            <fileset dir="${anthro.profile.plugin.dir}"/>
        </copy>
        <move file="${anthro.profile.plugin.name}@${anthro.profile.plugin.version}.min.js" todir="${jee.deploy.cspace.ui.shared}"></move>
        
        <!-- Dartmouth Vietname Profile -->
		<filter token="PLUGIN_VERSION" value="${dvp.profile.plugin.version}" />
        <copy todir="${jee.deploy.cspace}/${dvp.profile.plugin.dir}" filtering="true" overwrite="true">
            <fileset dir="${dvp.profile.plugin.dir}"/>
        </copy>
        <move file="${dvp.profile.plugin.name}@${dvp.profile.plugin.version}.min.js" todir="${jee.deploy.cspace.ui.shared}"></move>
    </target>
    
    <target name="undeploy" description="undeploy collectionspace ui components from ${jee.server.cspace}">
    	<!-- Core webapp -->
        <delete dir="${jee.deploy.cspace}/${cspace.ui.webapp}" />
        <delete file="${jee.deploy.cspace.ui.shared}/${cspace.ui.js}" />
        
        <!-- Public Art Profile -->
        <delete dir="${jee.deploy.cspace}/${publicart.profile.plugin.dir}" />
        <delete file="${jee.deploy.cspace.ui.shared}/${publicart.profile.plugin.js}" />
        
        <!-- Anthropology Profile -->
        <delete dir="${jee.deploy.cspace}/${anthro.profile.plugin.dir}" />
        <delete file="${jee.deploy.cspace.ui.shared}/${anthro.profile.plugin.js}" />
        
        <!-- Dartmouth Vietnam Project -->
        <delete dir="${jee.deploy.cspace}/${dvp.profile.plugin.dir}" />
        <delete file="${jee.deploy.cspace.ui.shared}/${dvp.profile.plugin.js}" />
    </target>
    
</project>
